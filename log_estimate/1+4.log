main start at this time 1675389982.4327219
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
EPOCH:  0
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 1.8671875 GB
    Memory Allocated: 0.34946680068969727  GigaBytes
Max Memory Allocated: 0.3498244285583496  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 2.59375 GB
    Memory Allocated: 1.0760293006896973  GigaBytes
Max Memory Allocated: 1.0760293006896973  GigaBytes

the msgdata generation time:  0.0012845993041992188

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 2.59375 GB
    Memory Allocated: 1.0760293006896973  GigaBytes
Max Memory Allocated: 1.0760293006896973  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0774941444396973  GigaBytes
Max Memory Allocated: 1.0774941444396973  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0774941444396973  GigaBytes
Max Memory Allocated: 1.0774941444396973  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0774941444396973  GigaBytes
Max Memory Allocated: 1.0774941444396973  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0007641315460205078
----------------------------------------after _bucketing() 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0810699462890625  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0811176300048828  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0811176300048828  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0811176300048828  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0811176300048828  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0811824798583984  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.595703125 GB
    Memory Allocated: 1.0811824798583984  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.607421875 GB
    Memory Allocated: 1.0822806358337402  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.607421875 GB
    Memory Allocated: 1.0822806358337402  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.607421875 GB
    Memory Allocated: 1.0822806358337402  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.607421875 GB
    Memory Allocated: 1.0822806358337402  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.607421875 GB
    Memory Allocated: 1.0822806358337402  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.607421875 GB
    Memory Allocated: 1.0824456214904785  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.607421875 GB
    Memory Allocated: 1.0824456214904785  GigaBytes
Max Memory Allocated: 1.0845870971679688  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.609375 GB
    Memory Allocated: 1.0850000381469727  GigaBytes
Max Memory Allocated: 1.08524751663208  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.609375 GB
    Memory Allocated: 1.0850000381469727  GigaBytes
Max Memory Allocated: 1.08524751663208  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.609375 GB
    Memory Allocated: 1.0850000381469727  GigaBytes
Max Memory Allocated: 1.08524751663208  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.609375 GB
    Memory Allocated: 1.0850000381469727  GigaBytes
Max Memory Allocated: 1.08524751663208  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.609375 GB
    Memory Allocated: 1.0850000381469727  GigaBytes
Max Memory Allocated: 1.08524751663208  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.609375 GB
    Memory Allocated: 1.0854182243347168  GigaBytes
Max Memory Allocated: 1.0854310989379883  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.609375 GB
    Memory Allocated: 1.0854182243347168  GigaBytes
Max Memory Allocated: 1.0854310989379883  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.6171875 GB
    Memory Allocated: 1.0916924476623535  GigaBytes
Max Memory Allocated: 1.0922503471374512  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.6171875 GB
    Memory Allocated: 1.0916924476623535  GigaBytes
Max Memory Allocated: 1.0922503471374512  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.6171875 GB
    Memory Allocated: 1.0916924476623535  GigaBytes
Max Memory Allocated: 1.0922503471374512  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.6171875 GB
    Memory Allocated: 1.0916924476623535  GigaBytes
Max Memory Allocated: 1.0922503471374512  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.6171875 GB
    Memory Allocated: 1.0916924476623535  GigaBytes
Max Memory Allocated: 1.0922503471374512  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.6171875 GB
    Memory Allocated: 1.092371940612793  GigaBytes
Max Memory Allocated: 1.092392921447754  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.6171875 GB
    Memory Allocated: 1.092371940612793  GigaBytes
Max Memory Allocated: 1.092392921447754  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.62890625 GB
    Memory Allocated: 1.10239839553833  GigaBytes
Max Memory Allocated: 1.103248119354248  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.62890625 GB
    Memory Allocated: 1.10239839553833  GigaBytes
Max Memory Allocated: 1.103248119354248  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.62890625 GB
    Memory Allocated: 1.10239839553833  GigaBytes
Max Memory Allocated: 1.103248119354248  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.62890625 GB
    Memory Allocated: 1.10239839553833  GigaBytes
Max Memory Allocated: 1.103248119354248  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.62890625 GB
    Memory Allocated: 1.10239839553833  GigaBytes
Max Memory Allocated: 1.103248119354248  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.62890625 GB
    Memory Allocated: 1.1032276153564453  GigaBytes
Max Memory Allocated: 1.10325288772583  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.62890625 GB
    Memory Allocated: 1.1032276153564453  GigaBytes
Max Memory Allocated: 1.10325288772583  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.64453125 GB
    Memory Allocated: 1.1153340339660645  GigaBytes
Max Memory Allocated: 1.1163291931152344  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.64453125 GB
    Memory Allocated: 1.1153340339660645  GigaBytes
Max Memory Allocated: 1.1163291931152344  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.64453125 GB
    Memory Allocated: 1.1153340339660645  GigaBytes
Max Memory Allocated: 1.1163291931152344  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.64453125 GB
    Memory Allocated: 1.1153340339660645  GigaBytes
Max Memory Allocated: 1.1163291931152344  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.64453125 GB
    Memory Allocated: 1.1153340339660645  GigaBytes
Max Memory Allocated: 1.1163291931152344  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.64453125 GB
    Memory Allocated: 1.1165637969970703  GigaBytes
Max Memory Allocated: 1.1166009902954102  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.64453125 GB
    Memory Allocated: 1.1165637969970703  GigaBytes
Max Memory Allocated: 1.1166009902954102  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.662109375 GB
    Memory Allocated: 1.1343936920166016  GigaBytes
Max Memory Allocated: 1.1358284950256348  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.662109375 GB
    Memory Allocated: 1.1343936920166016  GigaBytes
Max Memory Allocated: 1.1358284950256348  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.662109375 GB
    Memory Allocated: 1.1343936920166016  GigaBytes
Max Memory Allocated: 1.1358284950256348  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.662109375 GB
    Memory Allocated: 1.1343936920166016  GigaBytes
Max Memory Allocated: 1.1358284950256348  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.662109375 GB
    Memory Allocated: 1.1343936920166016  GigaBytes
Max Memory Allocated: 1.1358284950256348  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.662109375 GB
    Memory Allocated: 1.1367087364196777  GigaBytes
Max Memory Allocated: 1.1367602348327637  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.662109375 GB
    Memory Allocated: 1.1367087364196777  GigaBytes
Max Memory Allocated: 1.1367602348327637  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.705078125 GB
    Memory Allocated: 1.1613569259643555  GigaBytes
Max Memory Allocated: 1.1633095741271973  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.705078125 GB
    Memory Allocated: 1.1613569259643555  GigaBytes
Max Memory Allocated: 1.1633095741271973  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.705078125 GB
    Memory Allocated: 1.1613569259643555  GigaBytes
Max Memory Allocated: 1.1633095741271973  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.705078125 GB
    Memory Allocated: 1.1613569259643555  GigaBytes
Max Memory Allocated: 1.1633095741271973  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.705078125 GB
    Memory Allocated: 1.1613569259643555  GigaBytes
Max Memory Allocated: 1.1633095741271973  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.705078125 GB
    Memory Allocated: 1.1628828048706055  GigaBytes
Max Memory Allocated: 1.1633095741271973  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.705078125 GB
    Memory Allocated: 1.1628828048706055  GigaBytes
Max Memory Allocated: 1.1633095741271973  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.728515625 GB
    Memory Allocated: 1.1848173141479492  GigaBytes
Max Memory Allocated: 1.1865339279174805  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.728515625 GB
    Memory Allocated: 1.1848173141479492  GigaBytes
Max Memory Allocated: 1.1865339279174805  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.728515625 GB
    Memory Allocated: 1.1848173141479492  GigaBytes
Max Memory Allocated: 1.1865339279174805  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.728515625 GB
    Memory Allocated: 1.1848173141479492  GigaBytes
Max Memory Allocated: 1.1865339279174805  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.728515625 GB
    Memory Allocated: 1.1848173141479492  GigaBytes
Max Memory Allocated: 1.1865339279174805  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 2.728515625 GB
    Memory Allocated: 1.1867485046386719  GigaBytes
Max Memory Allocated: 1.1868066787719727  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 2.728515625 GB
    Memory Allocated: 1.1867485046386719  GigaBytes
Max Memory Allocated: 1.1868066787719727  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 2.755859375 GB
    Memory Allocated: 1.2144289016723633  GigaBytes
Max Memory Allocated: 1.2165746688842773  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 2.755859375 GB
    Memory Allocated: 1.214402198791504  GigaBytes
Max Memory Allocated: 1.2165746688842773  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 2.755859375 GB
    Memory Allocated: 1.214402198791504  GigaBytes
Max Memory Allocated: 1.2165746688842773  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 2.904296875 GB
    Memory Allocated: 1.289151668548584  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

invoke_udf_reduce time:  0.13252592086791992
preparing time:  0.23711824417114258
model forward time:  0.13565635681152344
loss calculation time:  0.00014972686767578125
partial loss calculation time:  0.0006470680236816406
loss backward time:  0.020039796829223633
----------------------------------------before msgdata gen 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 0.35068416595458984  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.0772466659545898  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

the msgdata generation time:  0.0003693103790283203

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.0772466659545898  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.0787115097045898  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.0787115097045898  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.0787115097045898  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010323524475097656
tmp = F.gather_row(idx, eqidx)  2.6464462280273438e-05
N = math.ceil(len(tmp)/num_split)  2.0503997802734375e-05
unique_val = np.asarray(list([degree.item()]))  4.6253204345703125e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.0843658447265625  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.084904670715332  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.084904670715332  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.084904670715332  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 2.9140625 GB
    Memory Allocated: 1.084904670715332  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 3.09375 GB
    Memory Allocated: 1.264592170715332  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 3.09375 GB
    Memory Allocated: 1.264592170715332  GigaBytes
Max Memory Allocated: 1.3623805046081543  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 3.844637393951416  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 3.844637393951416  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 3.844637393951416  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 3.9363436698913574  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

invoke_udf_reduce time:  0.10536384582519531
----------------------------------------before msgdata gen 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 0.393892765045166  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.120455265045166  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

the msgdata generation time:  0.0002200603485107422

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.120455265045166  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010609626770019531
tmp = F.gather_row(idx, eqidx)  2.7179718017578125e-05
N = math.ceil(len(tmp)/num_split)  2.0503997802734375e-05
unique_val = np.asarray(list([degree.item()]))  3.314018249511719e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.1275744438171387  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.1281132698059082  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.1281132698059082  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.1281132698059082  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.1281132698059082  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.3078007698059082  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 5.740234375 GB
    Memory Allocated: 1.3078007698059082  GigaBytes
Max Memory Allocated: 4.042263507843018  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.8873343467712402  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.8873343467712402  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.8873343467712402  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.9795517921447754  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

invoke_udf_reduce time:  0.09054923057556152
----------------------------------------before msgdata gen 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 0.393892765045166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.120455265045166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

the msgdata generation time:  0.0002143383026123047

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.120455265045166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010204315185546875
tmp = F.gather_row(idx, eqidx)  2.6226043701171875e-05
N = math.ceil(len(tmp)/num_split)  1.9311904907226562e-05
unique_val = np.asarray(list([degree.item()]))  3.075599670410156e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.1269001960754395  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.127439022064209  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.127439022064209  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.127439022064209  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.127439022064209  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.307126522064209  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.307126522064209  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.8869471549987793  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.8869471549987793  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.8869471549987793  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.9791646003723145  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

invoke_udf_reduce time:  0.09037375450134277
----------------------------------------before msgdata gen 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 0.393892765045166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.120455265045166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

the msgdata generation time:  0.000213623046875

current graph nodes  848910
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.120455265045166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.121920108795166  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010275840759277344
tmp = F.gather_row(idx, eqidx)  2.8133392333984375e-05
N = math.ceil(len(tmp)/num_split)  1.9311904907226562e-05
unique_val = np.asarray(list([degree.item()]))  3.0517578125e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.1275744438171387  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.1281132698059082  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.1281132698059082  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.1281132698059082  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.1281132698059082  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.3078007698059082  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 1.3078007698059082  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.887819290161133  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.887819290161133  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.887819290161133  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 3.979524612426758  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

invoke_udf_reduce time:  0.09082651138305664
split  buckets total input  1442210
preparing time:  0.06761479377746582
model forward time :  0.38592052459716797
model forward time + loss calculation time:  0.38635969161987305
loss backward time:  0.022847890853881836
-------------------------------------------------------------------------------loss_sum  :  tensor(4.7918)

EPOCH:  1
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 5.919921875 GB
    Memory Allocated: 0.3506035804748535  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0771660804748535  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

the msgdata generation time:  0.0012691020965576172

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0771660804748535  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0786309242248535  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0786309242248535  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0786309242248535  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006735324859619141
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0822067260742188  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.082254409790039  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.082254409790039  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.082254409790039  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.082254409790039  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0823192596435547  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0823192596435547  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0834174156188965  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0834174156188965  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0834174156188965  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0834174156188965  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0834174156188965  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0835824012756348  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0835824012756348  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086136817932129  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086136817932129  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086136817932129  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086136817932129  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086136817932129  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086555004119873  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086555004119873  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0928292274475098  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0928292274475098  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0928292274475098  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0928292274475098  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0928292274475098  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0935087203979492  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0935087203979492  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1035351753234863  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1035351753234863  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1035351753234863  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1035351753234863  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1035351753234863  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1043643951416016  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1043643951416016  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1164708137512207  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1164708137512207  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1164708137512207  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1164708137512207  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1164708137512207  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1177005767822266  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1177005767822266  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1355304718017578  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1355304718017578  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1355304718017578  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1355304718017578  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1355304718017578  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1372389793395996  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1372389793395996  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1618871688842773  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1618871688842773  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1618871688842773  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1618871688842773  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1618871688842773  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1639585494995117  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1639585494995117  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858930587768555  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858930587768555  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858930587768555  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858930587768555  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858930587768555  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1878242492675781  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1878242492675781  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2155046463012695  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2154779434204102  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2154779434204102  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2902274131774902  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

invoke_udf_reduce time:  0.10993719100952148
preparing time:  0.019974470138549805
model forward time:  0.11270737648010254
loss calculation time:  6.031990051269531e-05
partial loss calculation time:  0.0008442401885986328
loss backward time:  0.01702594757080078
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3514833450317383  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0780458450317383  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

the msgdata generation time:  0.00040531158447265625

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0780458450317383  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0795106887817383  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0795106887817383  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0795106887817383  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011205673217773438
tmp = F.gather_row(idx, eqidx)  2.574920654296875e-05
N = math.ceil(len(tmp)/num_split)  1.8835067749023438e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0844907760620117  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0850296020507812  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0850296020507812  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0850296020507812  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0850296020507812  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2647171020507812  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2647171020507812  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8442506790161133  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8442506790161133  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8442506790161133  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9364681243896484  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

invoke_udf_reduce time:  0.09620499610900879
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39469194412231445  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1212544441223145  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

the msgdata generation time:  0.00021219253540039062

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1212544441223145  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1227192878723145  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1227192878723145  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1227192878723145  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010800361633300781
tmp = F.gather_row(idx, eqidx)  2.6226043701171875e-05
N = math.ceil(len(tmp)/num_split)  1.8596649169921875e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127699375152588  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282382011413574  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282382011413574  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282382011413574  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282382011413574  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3079257011413574  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3079257011413574  GigaBytes
Max Memory Allocated: 4.0854716300964355  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8874592781066895  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8874592781066895  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8874592781066895  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9796767234802246  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

invoke_udf_reduce time:  0.09378266334533691
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39469194412231445  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1212544441223145  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

the msgdata generation time:  0.00022029876708984375

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1212544441223145  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1227192878723145  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1227192878723145  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1227192878723145  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010609626770019531
tmp = F.gather_row(idx, eqidx)  2.8848648071289062e-05
N = math.ceil(len(tmp)/num_split)  2.1219253540039062e-05
unique_val = np.asarray(list([degree.item()]))  3.409385681152344e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127699375152588  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282382011413574  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282382011413574  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282382011413574  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282382011413574  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3079257011413574  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3079257011413574  GigaBytes
Max Memory Allocated: 4.085596561431885  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8877463340759277  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8877463340759277  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8877463340759277  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979963779449463  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

invoke_udf_reduce time:  0.09152913093566895
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3952803611755371  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.121842861175537  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

the msgdata generation time:  0.00022673606872558594

current graph nodes  848027
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.121842861175537  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.123307704925537  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.123307704925537  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.123307704925537  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00012826919555664062
tmp = F.gather_row(idx, eqidx)  3.1948089599609375e-05
N = math.ceil(len(tmp)/num_split)  2.3365020751953125e-05
unique_val = np.asarray(list([degree.item()]))  5.435943603515625e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282877922058105  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.12882661819458  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.12882661819458  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.12882661819458  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.12882661819458  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.30851411819458  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.30851411819458  GigaBytes
Max Memory Allocated: 4.085883617401123  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8885326385498047  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8885326385498047  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8885326385498047  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9802379608154297  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09275174140930176
split  buckets total input  1440934
preparing time:  0.0760965347290039
model forward time :  0.3833494186401367
model forward time + loss calculation time:  0.38381195068359375
loss backward time:  0.022922754287719727
-------------------------------------------------------------------------------loss_sum  :  tensor(4.7273)

EPOCH:  2
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35109472274780273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0776572227478027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0003485679626464844

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0776572227478027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.000701904296875
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.082082748413086  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821952819824219  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821952819824219  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083458423614502  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083458423614502  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0864310264587402  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0864310264587402  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0933847427368164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0933847427368164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1042404174804688  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1042404174804688  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.11842679977417  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.11842679977417  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137965202331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137965202331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1641392707824707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1641392707824707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.188004970550537  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.188004970550537  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2156853675842285  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2156586647033691  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2156586647033691  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2907071113586426  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.11103630065917969
preparing time:  0.02023148536682129
model forward time:  0.11331748962402344
loss calculation time:  6.198883056640625e-05
partial loss calculation time:  0.0008389949798583984
loss backward time:  0.017156362533569336
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3519744873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785369873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00039505958557128906

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785369873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00012946128845214844
tmp = F.gather_row(idx, eqidx)  3.7670135498046875e-05
N = math.ceil(len(tmp)/num_split)  3.457069396972656e-05
unique_val = np.asarray(list([degree.item()]))  4.9114227294921875e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.084366798400879  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0849056243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0849056243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0849056243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0849056243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2645931243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2645931243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8441267013549805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8441267013549805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8441267013549805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9363441467285156  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.10235452651977539
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002753734588623047

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010228157043457031
tmp = F.gather_row(idx, eqidx)  2.574920654296875e-05
N = math.ceil(len(tmp)/num_split)  1.9073486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.24249267578125e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127575397491455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8873353004455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8873353004455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8873353004455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979552745819092  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09484624862670898
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021004676818847656

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010991096496582031
tmp = F.gather_row(idx, eqidx)  2.6464462280273438e-05
N = math.ceil(len(tmp)/num_split)  1.9073486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.0994415283203125e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127575397491455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887622356414795  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887622356414795  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887622356414795  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.97983980178833  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.0936746597290039
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021147727966308594

current graph nodes  848038
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010800361633300781
tmp = F.gather_row(idx, eqidx)  2.6702880859375e-05
N = math.ceil(len(tmp)/num_split)  2.002716064453125e-05
unique_val = np.asarray(list([degree.item()]))  3.314018249511719e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127575397491455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8878250122070312  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8878250122070312  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8878250122070312  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9795303344726562  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09285473823547363
split  buckets total input  1441351
preparing time:  0.07629156112670898
model forward time :  0.3927326202392578
model forward time + loss calculation time:  0.3931305408477783
loss backward time:  0.017641067504882812
-------------------------------------------------------------------------------loss_sum  :  tensor(4.6635)

EPOCH:  3
full batch graph loading time:  0.05444169044494629
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35010814666748047  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0766706466674805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002033710479736328

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0766706466674805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0781354904174805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0781354904174805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0781354904174805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0007183551788330078
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0817112922668457  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.081758975982666  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.081758975982666  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.081758975982666  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.081758975982666  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818238258361816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818238258361816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829219818115234  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829219818115234  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829219818115234  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829219818115234  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829219818115234  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830869674682617  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830869674682617  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856413841247559  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856413841247559  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856413841247559  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856413841247559  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856413841247559  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0860595703125  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0860595703125  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923337936401367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923337936401367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923337936401367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923337936401367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923337936401367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0930132865905762  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0930132865905762  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030397415161133  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030397415161133  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030397415161133  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030397415161133  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030397415161133  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1038689613342285  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1038689613342285  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159753799438477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159753799438477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159753799438477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159753799438477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159753799438477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1172051429748535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1172051429748535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350350379943848  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350350379943848  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350350379943848  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350350379943848  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350350379943848  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137350082397461  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137350082397461  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1619982719421387  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1619982719421387  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1619982719421387  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1619982719421387  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1619982719421387  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1635241508483887  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1635241508483887  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854586601257324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854586601257324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854586601257324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854586601257324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854586601257324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.187389850616455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.187389850616455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2150702476501465  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.215043544769287  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.215043544769287  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2898693084716797  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.11177682876586914
preparing time:  0.019850730895996094
model forward time:  0.11346840858459473
loss calculation time:  5.91278076171875e-05
partial loss calculation time:  0.0008406639099121094
loss backward time:  0.016681194305419922
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35098791122436523  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0775504112243652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00022482872009277344

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0775504112243652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0790152549743652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0790152549743652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0790152549743652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011038780212402344
tmp = F.gather_row(idx, eqidx)  3.4809112548828125e-05
N = math.ceil(len(tmp)/num_split)  2.002716064453125e-05
unique_val = np.asarray(list([degree.item()]))  3.1948089599609375e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.084669589996338  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852084159851074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852084159851074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852084159851074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852084159851074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2648959159851074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2648959159851074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8444294929504395  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8444294929504395  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8444294929504395  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9366469383239746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09415268898010254
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3941965103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207590103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002162456512451172

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207590103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010561943054199219
tmp = F.gather_row(idx, eqidx)  2.7179718017578125e-05
N = math.ceil(len(tmp)/num_split)  1.8596649169921875e-05
unique_val = np.asarray(list([degree.item()]))  3.147125244140625e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127878189086914  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081045150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081045150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8876380920410156  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8876380920410156  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8876380920410156  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979855537414551  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09258794784545898
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3941965103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207590103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00022125244140625

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207590103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010633468627929688
tmp = F.gather_row(idx, eqidx)  2.8133392333984375e-05
N = math.ceil(len(tmp)/num_split)  1.9550323486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.4332275390625e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127878189086914  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081045150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081045150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8881497383117676  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8881497383117676  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8881497383117676  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979856014251709  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09334993362426758
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3941965103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207590103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021719932556152344

current graph nodes  848349
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207590103149414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222238540649414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010442733764648438
tmp = F.gather_row(idx, eqidx)  2.9325485229492188e-05
N = math.ceil(len(tmp)/num_split)  1.9311904907226562e-05
unique_val = np.asarray(list([degree.item()]))  3.24249267578125e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127878189086914  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284170150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081045150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081045150756836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888123035430908  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888123035430908  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888123035430908  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979828357696533  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09386348724365234
split  buckets total input  1441871
preparing time:  0.07511043548583984
model forward time :  0.3812839984893799
model forward time + loss calculation time:  0.3816964626312256
loss backward time:  0.016418933868408203
-------------------------------------------------------------------------------loss_sum  :  tensor(4.5988)

pure train time 0.5283241271972656
EPOCH:  4
full batch graph loading time:  0.043092966079711914
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35109472274780273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0776572227478027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00019478797912597656

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0776572227478027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006830692291259766
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.082082748413086  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821952819824219  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821952819824219  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083458423614502  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083458423614502  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0864310264587402  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0864310264587402  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0933847427368164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0933847427368164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1042404174804688  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1042404174804688  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1175765991210938  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1175765991210938  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1377215385437012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1377215385437012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.163895606994629  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.163895606994629  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1877613067626953  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1877613067626953  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2154417037963867  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2154150009155273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2154150009155273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2901644706726074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.11255526542663574
preparing time:  0.022028446197509766
model forward time:  0.11426329612731934
loss calculation time:  6.461143493652344e-05
partial loss calculation time:  0.0008132457733154297
loss backward time:  0.015371322631835938
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3519744873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785369873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00018715858459472656

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785369873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011682510375976562
tmp = F.gather_row(idx, eqidx)  2.8371810913085938e-05
N = math.ceil(len(tmp)/num_split)  1.8358230590820312e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0850410461425781  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0855798721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0855798721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0855798721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0855798721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2652673721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2652673721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8453125953674316  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8453125953674316  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8453125953674316  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.937018871307373  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09444165229797363
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002269744873046875

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010538101196289062
tmp = F.gather_row(idx, eqidx)  2.9087066650390625e-05
N = math.ceil(len(tmp)/num_split)  2.0503997802734375e-05
unique_val = np.asarray(list([degree.item()]))  3.147125244140625e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282496452331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888521194458008  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888521194458008  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888521194458008  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.980227470397949  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09557867050170898
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00024437904357910156

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010561943054199219
tmp = F.gather_row(idx, eqidx)  2.765655517578125e-05
N = math.ceil(len(tmp)/num_split)  1.8358230590820312e-05
unique_val = np.asarray(list([degree.item()]))  3.1948089599609375e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127575397491455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888134002685547  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888134002685547  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888134002685547  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9798402786254883  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09529280662536621
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021195411682128906

current graph nodes  848190
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010633468627929688
tmp = F.gather_row(idx, eqidx)  2.8133392333984375e-05
N = math.ceil(len(tmp)/num_split)  1.8358230590820312e-05
unique_val = np.asarray(list([degree.item()]))  3.314018249511719e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282496452331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8884973526000977  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8884973526000977  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8884973526000977  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9802026748657227  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.10347676277160645
split  buckets total input  1441822
preparing time:  0.08036661148071289
model forward time :  0.3958721160888672
model forward time + loss calculation time:  0.39629435539245605
loss backward time:  0.01858830451965332
-------------------------------------------------------------------------------loss_sum  :  tensor(4.5354)

pure train time 0.5445818901062012
EPOCH:  5
full batch graph loading time:  0.0695497989654541
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35071420669555664  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0772767066955566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00019502639770507812

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0772767066955566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0787415504455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0787415504455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0787415504455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0007016658782958984
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0817022323608398  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0817499160766602  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0817499160766602  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0817499160766602  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0817499160766602  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818147659301758  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818147659301758  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829129219055176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829129219055176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829129219055176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829129219055176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829129219055176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830779075622559  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830779075622559  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.08563232421875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.08563232421875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.08563232421875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.08563232421875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.08563232421875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0860505104064941  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0860505104064941  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923247337341309  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923247337341309  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923247337341309  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923247337341309  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923247337341309  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0930042266845703  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0930042266845703  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030306816101074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030306816101074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030306816101074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030306816101074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030306816101074  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1038599014282227  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1038599014282227  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159663200378418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159663200378418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159663200378418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159663200378418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159663200378418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1180462837219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1180462837219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135876178741455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135876178741455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135876178741455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135876178741455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135876178741455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1375846862792969  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1375846862792969  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1622328758239746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1622328758239746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1622328758239746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1622328758239746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1622328758239746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1637587547302246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1637587547302246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1856932640075684  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1856932640075684  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1856932640075684  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1856932640075684  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1856932640075684  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.187624454498291  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.187624454498291  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2153048515319824  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.215278148651123  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.215278148651123  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2903265953063965  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.11265158653259277
preparing time:  0.027642011642456055
model forward time:  0.11434698104858398
loss calculation time:  7.05718994140625e-05
partial loss calculation time:  0.0008375644683837891
loss backward time:  0.01284170150756836
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3515939712524414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0781564712524414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00018596649169921875

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0781564712524414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0796213150024414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0796213150024414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0796213150024414  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0001068115234375
tmp = F.gather_row(idx, eqidx)  2.8848648071289062e-05
N = math.ceil(len(tmp)/num_split)  1.9550323486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.075599670410156e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0839862823486328  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0845251083374023  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0845251083374023  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0845251083374023  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0845251083374023  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2642126083374023  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2642126083374023  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8437461853027344  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8437461853027344  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8437461853027344  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9359636306762695  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09702038764953613
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3948025703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1213650703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00023365020751953125

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1213650703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010800361633300781
tmp = F.gather_row(idx, eqidx)  2.8848648071289062e-05
N = math.ceil(len(tmp)/num_split)  2.0742416381835938e-05
unique_val = np.asarray(list([degree.item()]))  3.1948089599609375e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127194881439209  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3074212074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3074212074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8869547843933105  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8869547843933105  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8869547843933105  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9791722297668457  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09972977638244629
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3948025703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1213650703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00022673606872558594

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1213650703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010967254638671875
tmp = F.gather_row(idx, eqidx)  2.9087066650390625e-05
N = math.ceil(len(tmp)/num_split)  1.9550323486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.361701965332031e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127194881439209  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3074212074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3074212074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887241840362549  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887241840362549  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887241840362549  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979459285736084  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09375190734863281
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3948025703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1213650703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021719932556152344

current graph nodes  848325
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1213650703430176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1228299140930176  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010633468627929688
tmp = F.gather_row(idx, eqidx)  2.7894973754882812e-05
N = math.ceil(len(tmp)/num_split)  2.0265579223632812e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127194881439209  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1277337074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3074212074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3074212074279785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887444496154785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887444496154785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887444496154785  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.97914981842041  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.0948946475982666
split  buckets total input  1442597
preparing time:  0.07489252090454102
model forward time :  0.3924074172973633
model forward time + loss calculation time:  0.39281463623046875
loss backward time:  0.015678882598876953
-------------------------------------------------------------------------------loss_sum  :  tensor(4.4706)

pure train time 0.5357527732849121
EPOCH:  6
full batch graph loading time:  0.04993891716003418
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3504796028137207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0770421028137207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0003046989440917969

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0770421028137207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785069465637207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785069465637207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785069465637207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006711483001708984
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.082082748413086  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821952819824219  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821952819824219  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083458423614502  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083458423614502  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0864310264587402  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0864310264587402  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0933847427368164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0933847427368164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1042404174804688  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1042404174804688  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1175765991210938  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1175765991210938  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135406494140625  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1377215385437012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1377215385437012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.162369728088379  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.163895606994629  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.163895606994629  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1858301162719727  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1877613067626953  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1877613067626953  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2154417037963867  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2154150009155273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2154150009155273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.29024076461792  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.11524796485900879
preparing time:  0.0205233097076416
model forward time:  0.11752796173095703
loss calculation time:  9.989738464355469e-05
partial loss calculation time:  0.0007922649383544922
loss backward time:  0.011754512786865234
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35135936737060547  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0779218673706055  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00016689300537109375

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0779218673706055  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0793867111206055  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0793867111206055  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0793867111206055  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010347366333007812
tmp = F.gather_row(idx, eqidx)  2.8371810913085938e-05
N = math.ceil(len(tmp)/num_split)  2.0742416381835938e-05
unique_val = np.asarray(list([degree.item()]))  4.363059997558594e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0850410461425781  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0855798721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0855798721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0855798721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0855798721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2652673721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2652673721313477  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8448009490966797  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8448009490966797  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8448009490966797  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.937018394470215  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09591150283813477
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39456796646118164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1211304664611816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021648406982421875

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1211304664611816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010919570922851562
tmp = F.gather_row(idx, eqidx)  2.7894973754882812e-05
N = math.ceil(len(tmp)/num_split)  1.8596649169921875e-05
unique_val = np.asarray(list([degree.item()]))  3.314018249511719e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282496452331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888009548187256  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888009548187256  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888009548187256  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.980226993560791  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.0959467887878418
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39456796646118164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1211304664611816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00034427642822265625

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1211304664611816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0001251697540283203
tmp = F.gather_row(idx, eqidx)  3.361701965332031e-05
N = math.ceil(len(tmp)/num_split)  1.9550323486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.743171691894531e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282496452331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888521194458008  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888521194458008  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.888521194458008  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.980227470397949  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09655022621154785
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39456796646118164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1211304664611816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021767616271972656

current graph nodes  847553
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1211304664611816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1225953102111816  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010752677917480469
tmp = F.gather_row(idx, eqidx)  2.765655517578125e-05
N = math.ceil(len(tmp)/num_split)  1.8835067749023438e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1282496452331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1287884712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3084759712219238  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8884944915771484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8884944915771484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8884944915771484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9801998138427734  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09685349464416504
split  buckets total input  1441226
preparing time:  0.0745697021484375
model forward time :  0.3924427032470703
model forward time + loss calculation time:  0.3928639888763428
loss backward time:  0.01858043670654297
-------------------------------------------------------------------------------loss_sum  :  tensor(4.4048)

pure train time 0.5408267974853516
EPOCH:  7
full batch graph loading time:  0.044199466705322266
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35081052780151367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0773730278015137  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00019621849060058594

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0773730278015137  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0788378715515137  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0788378715515137  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0788378715515137  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006706714630126953
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0817985534667969  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818462371826172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818462371826172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818462371826172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818462371826172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0819110870361328  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0819110870361328  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830092430114746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830092430114746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830092430114746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830092430114746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0830092430114746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083174228668213  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083174228668213  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.085728645324707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.085728645324707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.085728645324707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.085728645324707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.085728645324707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0861468315124512  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0861468315124512  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092421054840088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092421054840088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092421054840088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092421054840088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092421054840088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0931005477905273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0931005477905273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1031270027160645  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1031270027160645  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1031270027160645  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1031270027160645  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1031270027160645  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1039562225341797  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1039562225341797  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1160626411437988  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1160626411437988  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1160626411437988  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1160626411437988  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1160626411437988  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1172924041748047  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1172924041748047  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135122299194336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135122299194336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135122299194336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135122299194336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.135122299194336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137437343597412  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137437343597412  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620855331420898  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620855331420898  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620855331420898  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620855331420898  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620855331420898  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1636114120483398  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1636114120483398  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1855459213256836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1855459213256836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1855459213256836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1855459213256836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1855459213256836  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1874771118164062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1874771118164062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2151575088500977  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2151308059692383  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2151308059692383  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2898802757263184  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.1154482364654541
preparing time:  0.020195722579956055
model forward time:  0.11713004112243652
loss calculation time:  6.198883056640625e-05
partial loss calculation time:  0.0008482933044433594
loss backward time:  0.009786128997802734
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35169029235839844  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0782527923583984  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0001647472381591797

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0782527923583984  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0797176361083984  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0797176361083984  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0797176361083984  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010585784912109375
tmp = F.gather_row(idx, eqidx)  2.86102294921875e-05
N = math.ceil(len(tmp)/num_split)  1.9788742065429688e-05
unique_val = np.asarray(list([degree.item()]))  3.266334533691406e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.084756851196289  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852956771850586  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852956771850586  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852956771850586  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852956771850586  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2649831771850586  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2649831771850586  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8450284004211426  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8450284004211426  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8450284004211426  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.936734676361084  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09604763984680176
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3948988914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1214613914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002193450927734375

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1214613914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011658668518066406
tmp = F.gather_row(idx, eqidx)  2.765655517578125e-05
N = math.ceil(len(tmp)/num_split)  1.8835067749023438e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1279654502868652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1285042762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1285042762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1285042762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1285042762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081917762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081917762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8882369995117188  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8882369995117188  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8882369995117188  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.97994327545166  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09573984146118164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3948988914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1214613914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021505355834960938

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1214613914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010609626770019531
tmp = F.gather_row(idx, eqidx)  2.9325485229492188e-05
N = math.ceil(len(tmp)/num_split)  1.8835067749023438e-05
unique_val = np.asarray(list([degree.item()]))  3.2901763916015625e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127291202545166  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1278300285339355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1278300285339355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1278300285339355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1278300285339355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3075175285339355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3075175285339355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887849807739258  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887849807739258  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887849807739258  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979556083679199  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09582209587097168
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3948988914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1214613914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002181529998779297

current graph nodes  848583
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1214613914489746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1229262351989746  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011610984802246094
tmp = F.gather_row(idx, eqidx)  2.9087066650390625e-05
N = math.ceil(len(tmp)/num_split)  1.8835067749023438e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1279654502868652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1285042762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1285042762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1285042762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1285042762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081917762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081917762756348  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8882131576538086  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8882131576538086  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8882131576538086  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9799184799194336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09698319435119629
split  buckets total input  1441628
preparing time:  0.07480216026306152
model forward time :  0.3913702964782715
model forward time + loss calculation time:  0.39177775382995605
loss backward time:  0.017073631286621094
-------------------------------------------------------------------------------loss_sum  :  tensor(4.3381)

pure train time 0.5358295440673828
EPOCH:  8
full batch graph loading time:  0.056585073471069336
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.35109472274780273  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0776572227478027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00019311904907226562

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0776572227478027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0791220664978027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0007212162017822266
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.082082748413086  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821304321289062  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821952819824219  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0821952819824219  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0832934379577637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083458423614502  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.083458423614502  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086012840270996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0864310264587402  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0864310264587402  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.092705249786377  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0933847427368164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0933847427368164  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1034111976623535  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1042404174804688  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1042404174804688  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.116346836090088  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.11842679977417  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.11842679977417  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1362566947937012  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137965202331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137965202331543  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1626133918762207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1641392707824707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1641392707824707  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1860737800598145  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.188004970550537  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.188004970550537  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2156853675842285  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2156586647033691  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2156586647033691  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2907071113586426  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.11460399627685547
preparing time:  0.020331382751464844
model forward time:  0.11631250381469727
loss calculation time:  5.7220458984375e-05
partial loss calculation time:  0.0008382797241210938
loss backward time:  0.015550613403320312
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3519744873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785369873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021839141845703125

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0785369873046875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0800018310546875  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010514259338378906
tmp = F.gather_row(idx, eqidx)  2.86102294921875e-05
N = math.ceil(len(tmp)/num_split)  1.8835067749023438e-05
unique_val = np.asarray(list([degree.item()]))  3.24249267578125e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.084366798400879  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0849056243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0849056243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0849056243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0849056243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2645931243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2645931243896484  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8441267013549805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8441267013549805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8441267013549805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9363441467285156  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09546184539794922
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00022649765014648438

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010538101196289062
tmp = F.gather_row(idx, eqidx)  2.956390380859375e-05
N = math.ceil(len(tmp)/num_split)  1.9788742065429688e-05
unique_val = np.asarray(list([degree.item()]))  3.337860107421875e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127575397491455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8873353004455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8873353004455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8873353004455566  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979552745819092  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09590983390808105
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002162456512451172

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010943412780761719
tmp = F.gather_row(idx, eqidx)  2.86102294921875e-05
N = math.ceil(len(tmp)/num_split)  1.9550323486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127575397491455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887622356414795  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887622356414795  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.887622356414795  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.97983980178833  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09601521492004395
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39518308639526367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00021648406982421875

current graph nodes  848110
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1217455863952637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1232104301452637  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010704994201660156
tmp = F.gather_row(idx, eqidx)  2.9325485229492188e-05
N = math.ceil(len(tmp)/num_split)  1.9311904907226562e-05
unique_val = np.asarray(list([degree.item()]))  3.170967102050781e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127575397491455  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1281142234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3078017234802246  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8878250122070312  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8878250122070312  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8878250122070312  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9795303344726562  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09703302383422852
split  buckets total input  1441113
preparing time:  0.07503771781921387
model forward time :  0.39169883728027344
model forward time + loss calculation time:  0.3921079635620117
loss backward time:  0.01675558090209961
-------------------------------------------------------------------------------loss_sum  :  tensor(4.2706)

pure train time 0.5407838821411133
EPOCH:  9
full batch graph loading time:  0.046178340911865234
group buckets input  18164
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3501315116882324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0766940116882324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.000202178955078125

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], device='cuda:0', dtype=torch.int32)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0766940116882324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0781588554382324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0781588554382324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0781588554382324  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.0006778240203857422
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0817346572875977  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  173
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.081782341003418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.081782341003418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.081782341003418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  173
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.081782341003418  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818471908569336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0818471908569336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829453468322754  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  221
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829453468322754  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829453468322754  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829453468322754  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  442
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0829453468322754  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0831103324890137  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0831103324890137  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856647491455078  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  374
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856647491455078  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856647491455078  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856647491455078  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1122
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0856647491455078  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086082935333252  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.086082935333252  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923571586608887  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  456
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923571586608887  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923571586608887  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923571586608887  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  1824
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0923571586608887  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0930366516113281  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0930366516113281  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030631065368652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  445
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030631065368652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030631065368652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030631065368652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  2225
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1030631065368652  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1038923263549805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1038923263549805  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159987449645996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  550
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159987449645996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159987449645996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159987449645996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  3300
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1159987449645996  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1172285079956055  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1172285079956055  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350584030151367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  655
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350584030151367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350584030151367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350584030151367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4585
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1350584030151367  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137373447418213  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.137373447418213  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620216369628906  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  512
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620216369628906  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620216369628906  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620216369628906  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  4096
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1620216369628906  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1635475158691406  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1635475158691406  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854820251464844  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  576
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854820251464844  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854820251464844  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854820251464844  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  5184
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1854820251464844  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.187413215637207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.187413215637207  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2150936126708984  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.215066909790039  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.215066909790039  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2898926734924316  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.11585807800292969
preparing time:  0.020327091217041016
model forward time:  0.11759757995605469
loss calculation time:  6.413459777832031e-05
partial loss calculation time:  0.0008265972137451172
loss backward time:  0.016937971115112305
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.3510112762451172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0775737762451172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0003876686096191406

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0775737762451172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0790386199951172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0790386199951172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0790386199951172  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011754035949707031
tmp = F.gather_row(idx, eqidx)  2.8371810913085938e-05
N = math.ceil(len(tmp)/num_split)  1.71661376953125e-05
unique_val = np.asarray(list([degree.item()]))  3.0994415283203125e-05
step:  0
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0846929550170898  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852317810058594  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852317810058594  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852317810058594  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.0852317810058594  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2649192810058594  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.2649192810058594  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8444528579711914  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8444528579711914  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8444528579711914  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9366703033447266  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.1031184196472168
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39421987533569336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207823753356934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002276897430419922

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207823753356934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011038780212402344
tmp = F.gather_row(idx, eqidx)  2.9087066650390625e-05
N = math.ceil(len(tmp)/num_split)  1.9073486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.218650817871094e-05
step:  1
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127901554107666  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081278800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081278800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8876614570617676  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8876614570617676  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8876614570617676  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.9798789024353027  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09609317779541016
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39421987533569336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207823753356934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.0002288818359375

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207823753356934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00011301040649414062
tmp = F.gather_row(idx, eqidx)  2.86102294921875e-05
N = math.ceil(len(tmp)/num_split)  1.9788742065429688e-05
unique_val = np.asarray(list([degree.item()]))  3.24249267578125e-05
step:  2
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127901554107666  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48153
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481530
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081278800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081278800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8881731033325195  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8881731033325195  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.8881731033325195  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979879379272461  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.10079741477966309
----------------------------------------before msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 0.39421987533569336  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata gen 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207823753356934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

the msgdata generation time:  0.00023603439331054688

current graph nodes  848411
current graph dst nodes  196571
current graph edges  1949041
---------- degree  tensor(10)
----------------------------------------start invoke_udf_reduce() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1207823753356934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after msgdata = Frame(msgdata) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1222472190856934  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

eqidx = F.nonzero_1d(F.equal(sorted_val, v))  0.00010919570922851562
tmp = F.gather_row(idx, eqidx)  2.8133392333984375e-05
N = math.ceil(len(tmp)/num_split)  1.9550323486328125e-05
unique_val = np.asarray(list([degree.item()]))  3.266334533691406e-05
step:  3
----------------------------------------after _bucketing() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.127901554107666  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len node_bkt:  48150
----------------------------------------before bkt_nodes.append(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------start msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after ndata_bkt = dstdata.subframe(node_bkt) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

len eid_bkt:  481500
----------------------------------------after msgdata_bkt generation 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.1284403800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------before NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081278800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after NodeBatch() 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 1.3081278800964355  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after reduce func(NodeBatch) 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.88814640045166  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------Before Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.88814640045166  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after Frame()  
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.88814640045166  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

----------------------------------------after merge nodes 
 Nvidia-smi: 6.646484375 GB
    Memory Allocated: 3.979851722717285  GigaBytes
Max Memory Allocated: 4.08615779876709  GigaBytes

invoke_udf_reduce time:  0.09905886650085449
split  buckets total input  1441544
preparing time:  0.07663393020629883
model forward time :  0.40793943405151367
model forward time + loss calculation time:  0.40836453437805176
loss backward time:  0.01874852180480957
-------------------------------------------------------------------------------loss_sum  :  tensor(4.1990)

pure train time 0.5617127418518066

avg epoch time:  2.320780481610979
avg pure train time:  0.5411159651620048
avg block subtensor loading time:  0.13132194110325404
avg preparing time:  0.18566489219665527
avg block to device time:  0.01631127085004534
avg grouping time:  0.15267562866210938
avg splitting time:  1.7677807807922363
avg optimizing time:  0.0011364051273890904

avg input nodes number :  1459849.857142857
avg real block input nodes number :  848217.2857142857
avg input nodes number/pure train time :  2697850.2781853653
avg input nodes number/avg epoch time :  629034.0119240818
